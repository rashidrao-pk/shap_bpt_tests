# Shapley image explanations with data-aware Binary Partition Trees

This folder contains all notebook folders for various applications of ShapBPT including:

# Folders:
- [`CSV`](CSV/) contains precomputed CSV files saved by running [`N1_MS_COCO.ipynb`](N1_MS_COCO.ipynb).
- [`results`](results/) contains heatmaps and IoU files generated by running [`N1_MS_COCO.ipynb`](N1_MS_COCO.ipynb).

<!-- <hr> -->

# Files:

## 1. N1_MS_COCO
- [`N1_MS_COCO.ipynb`](/N1_MS_COCO.ipynb)


<!-- ######################################################### -->
### Predictions from model:

<center>
<img src="results/yolo11s_gray/single/113235_yolo_predictions.png" width=70%>

<caption> Objects with Top predictions in image no 113235 (MS-COC) using yolov11 model</caption>
</center>
<hr>
<center>
<img src="results/yolo11s_gray/single/113235_gray_bg_gt.png" width=90%>

<caption> Objects with Top predictions in image no 113235 (MS-COC) using yolov11 model</caption>
</center>

### Single Example with selected XAI methods:
<center>
<img src="results/yolo11s_gray/single/113235_gray_heatmap.png">
<caption> Single Example of heatmap for image 113235 with gray replacement values and yolov11 model</caption>
</center>

### Evaluation:

<center>
<img src="results/yolo11s_gray/single/113235_gray_PM.png">
<caption> AUC & MSE evaluation curves for image 113235 </caption>
</center>

<hr>
<center>
<img src="results/yolo11s_gray/single/113235_gray_IoU.png">
<caption> Single Example of groundtruth based evaluation for image 113235</caption>
</center>
<hr>

<center>
<img src="results/yolo11s_gray/single/113235_gray_PM_iou.png">
<caption> Single Example of max-IoU used for groundtruth based evaluation for the image no 113235 </caption>
</center>
<hr>


### Ful Test :
This part of the notebook is used to compute results on full set (validation set from MS-COCO) of images.


## 2. N2_DrawPlot_from_CSV
- [`N2_DrawPlot_from_CSV.ipynb`](/N2_DrawPlot_from_CSV.ipynb)
- This notebook is used to draw boxplots using computed CSV file.

### Boxplots 

<center>
<img src="boxplot/yolo11s_gray_7.png">
<caption> Full results for Exp E5 on 5000 images and 7 XAI methods BPT-100, BPT-500, BPT-1000, AA-100, AA-500, AA-1000, LIME-50</caption>
</center>

